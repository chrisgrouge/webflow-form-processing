<!-- Acoustic Web Tracking Script -->
<script src="https://www.sc.pages05.net/lp/static/js/iMAWebCookie.js?a4146e8-12a86642aaa-c6f842ded9e6d11c5ffebd715e129037&h=www.pages05.net" type="text/javascript"></script>

<!-- Acoustic Campaign Pageview Event -->
<script type='text/javascript'>
window.onload = (event) => {
	ewt.track({name:document.title,type:'webflow-website-view'});
}
</script>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-FTRD"
                  loading="lazy" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<script type="text/javascript">
  window._mfq = window._mfq || [];
  (function() {
    var mf = document.createElement("script");
    mf.type = "text/javascript"; mf.defer = true;
    mf.src = "//cdn.mouseflow.com/projects/3dad87ed-da3a-4a23-a33c-78b43f8e97c6.js";
    document.getElementsByTagName("head")[0].appendChild(mf);
  })();
</script>

<noscript>
  <img src=https://ws.zoominfo.com/pixel/KYfrEsjBKzuUx8FPC9VA loading="lazy" width="1" height="1" style="display: none;" />
</noscript>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-3790271-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-3790271-3');
</script>

<script src="https://cdn.finsweet.com/files/sweet-text/richtext-stylesystem-v1.0.min.js" data-info="code"></script>
<script>
  // On Back Button Tap
  window.onpageshow = function(event) {
    if (event.persisted) {
      window.location.reload()
    }
  };
</script>

<script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@3.6.12/dist/js/splide.min.js"></script>

<script>
  const splide = new Splide ( '#full-slider' , {
    type: 'slide',
    perPage : 1,
    arrows: true,
    
  });

	splide.mount();

 
</script>
<script>
  const halfsplide = new Splide ( '#half-slider' , {
    type: 'slide',
    perPage : 1,
    arrows: true,
    
  });

	halfsplide.mount();
  
</script>

<!-- Forms and Recaptcha -->
<script>
function validateEmail(contactemail) {
  var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
  return re.test(String(contactemail).toLowerCase());
}

$('#footer-email').keyup(function(){
  let isValid = $(this).is(':valid') && validateEmail($(this).val());
  if (isValid) {
    $('#footer-email').addClass("success");
    $('#footer-email').removeClass("error");
    $('#error-footer-email').hide();
  } else {
    $('#footer-email').removeClass("success");
    $('#footer-email').addClass("error");
    $('#error-footer-email').show();
  }
});

// removing the required attribute from checkboxes when at least one is selected
$(function(){
  var checkbox = $(":checkbox[required]");
  var parentID = checkbox.parent().attr("id");
  checkbox.change(function(){
    if(checkbox.is(":checked")) {
      checkbox.removeAttr("required");
      checkbox.parent().next().hide();
    } else {
      checkbox.attr("required","required");
      checkbox.parent().next().show();
    }
  });
});

function acousticFormLoadingState(isLoading, form) {
 if (isLoading) {
   form.find(".contact-submit-arrow-2 svg:first").hide();
   form.find(".AcousticFormLoading").css("display", "block");
 }
 else {
   form.find(".contact-submit-arrow-2 svg:first").show();
   form.find(".AcousticFormLoading").css("display", "none");
 }  
}

// Acoustic form validation
const acousticFormValidation = {
  form: null,
  fields: 0,
  validFields: 0,
  _handleInvalidInput(id, name) {
    $(this).addClass("error").removeClass("success");
    $("#error-" + id).show();
    console.error(`Invalid input value: ${name}`);
  },
  _handleUncheckedInput(name) {
    var parentID = form.find("input[name='" + name + "']").parent().attr("id");
    $(this).addClass("error").removeClass("success");
    $("#error-" + parentID).show();
    console.error(`Invalid checkbox: ${name}`);
  },
  _handleValidInput(id) {
    validFields++;
    $(this).removeClass("error").addClass("success");
    $("#error-" + id).hide();
  },
  _validateField(field, checkboxCheckedLength) {
    const value = $(field).val(),
          id = $(field).attr("id"),
          name = $(field).attr("name"),
          type = $(field).attr("type"),
          isValidEmail = value != "" && validateEmail(value);
    
    fields++;
    
    switch (true) {
      case name == "Email" && !isValidEmail:
        this._handleInvalidInput(id, name);
        break;
      case (type == "checkbox" && checkboxCheckedLength == 0) || (type == "radio" && checkboxCheckedLength == 0):
        this._handleUncheckedInput(name);
        break;
      case $(this).is("select") && $("#" + id + " option:selected").val() == "":
        this._handleInvalidInput(id, name);
        break;
      case value == "":
        this._handleInvalidInput(id, name);
        break;
      default:
        this._handleValidInput(id);
    }
  },
  submitForm(event) {
    event.preventDefault();
    form = $(event.target);
    fields = this.fields;
    validFields = this.validFields;

    // for each required input, check if it's valid and increment the validFields counter
    form.find("input:required, textarea:required, select:required").each((index, element) => {
      let countCheckboxes = form.find("input[type='checkbox']:checked").length;
      
      // adding a work around for the unsubscribe form becuase it technically has two radios with different names but are supposed to act like one fieldset of radios
      if(form.attr("id") == "unsubscribe") {
        const countUnsubRadios = form.find("input[type='radio']:checked").length;
        if(countUnsubRadios > 0) {
          countCheckboxes++;
        }
      }
      
      this._validateField($(element), countCheckboxes);
    });

    // console.log("Total required inputs: " + fields, "  |  Total valid inputs: " + validFields);
    
    // if all required inputs are valid, submit the form
    if(fields === validFields) {
      event.target.submit();
      return
    }

    // default to stop loading animation becuase not all required inputs are valid and the form will not submit
    acousticFormLoadingState(false, form);
  }
};

const recaptchaSubmit = {
  button: null,
  form: null,
  recaptcha: null,
  _executeRecaptcha(resolve, reject) {
    try {
      grecaptcha.ready(() => {
        grecaptcha
          .execute('6LdtEAkeAAAAAOioARNXsjsYyY2E4hCK9B0GrUCj', {action: 'submit'})
          .then((token) => {
            if (recaptcha.length) {
              recaptcha.val(token);
            } else {
              form.append('<input type="hidden" name="g-recaptcha-response" value="' + token + '">');
            }
            resolve();
          })
          .catch((error) => {
            console.error('Error: grecaptcha failed to execute. ' + error);
            // stop loading animation and reject promise
            acousticFormLoadingState(false, form);
            reject();
          });
      });
    } catch (error) {
      console.error('Error: grecaptcha is not ready. ' + error);
      // stop loading animation and reject promise
      acousticFormLoadingState(false, form);
      reject();
    }
  },
  submitForm(event) {
    event.preventDefault();
    button = $(event.target);
    form = button.closest('form');
    recaptcha = form.find("[name='g-recaptcha-response']");
    
    // initiate loading animation
    acousticFormLoadingState(true, form);

    // execute recaptcha and submit form if successful
    new Promise((resolve, reject) => {
      this._executeRecaptcha(resolve, reject);
    }).then(() => {
      form.submit();
    });
  }
};

$(document).ready(function() {
  // on click of submit button, execute recaptcha and submit form if successful
  $(".recaptcha-send-btn").click(recaptchaSubmit.submitForm.bind(recaptchaSubmit));

  // recaptchaSubmit.submitForm() will submit the form if recaptcha is successful.
  $(".AcousticForm, #preference-center, #unsubscribe").on("submit", acousticFormValidation.submitForm.bind(acousticFormValidation));
});
</script>

<!-- ACOUSTIC CAMPAIGN PREFERENCE CENTER AND OPT OUT FORM -->
<script>
  $(document).ready(function () {
    "use strict";

    // Get current date
    var d = new Date();
    var month = d.getMonth()+1;
    var day = d.getDate();
    var output = 
        (month<10 ? '0' : '') + month + '/' +
        (day<10 ? '0' : '') + day + '/' +
        d.getFullYear();
    $("input[name='Preferences Set Date'], input[name='2022 OptIn Date'], input[name='Contact Us Submission Date']").val(output);


    // EMAIL FREQUENCY - radios
    const $unsubscribe = $("#unsubscribe");
    const action = $unsubscribe.attr("action");
    const $snooze = $("#snooze");
    const $unsub = $("#unsub");

    // adding a work around for the unsubscribe form becuase it technically has two radios with different
    // names but are supposed to act like one fieldset of radios so when one is selected we don't need
    // either to be flagged as required on submit.
    function removeRequiredAttribute() {
      $unsub.removeAttr("required");
      $snooze.removeAttr("required");
    }

    $snooze.on("click", function() {
      if ($unsub.is(":checked")) {
        $unsub.prop("checked", false);
      }
      removeRequiredAttribute();
      $unsubscribe.attr("action", action + "?frequency=snoozed");
    });

    $unsub.on("click", function() {
      if ($snooze.is(":checked")) {
        $snooze.prop("checked", false);
      }
      removeRequiredAttribute();
      $unsubscribe.attr("action", action + "?frequency=unsubscribed");
    });
  });
</script>