<!-- Acoustic Web Tracking Script -->
<script src="https://www.sc.pages05.net/lp/static/js/iMAWebCookie.js?a4146e8-12a86642aaa-c6f842ded9e6d11c5ffebd715e129037&h=www.pages05.net" type="text/javascript"></script>

<!-- Acoustic Campaign Pageview Event -->
<script type='text/javascript'>
window.onload = (event) => {
	ewt.track({name:document.title,type:'webflow-website-view'});
}
</script>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-FTRD"
                  loading="lazy" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<script type="text/javascript">
  window._mfq = window._mfq || [];
  (function() {
    var mf = document.createElement("script");
    mf.type = "text/javascript"; mf.defer = true;
    mf.src = "//cdn.mouseflow.com/projects/3dad87ed-da3a-4a23-a33c-78b43f8e97c6.js";
    document.getElementsByTagName("head")[0].appendChild(mf);
  })();
</script>

<noscript>
  <img src=https://ws.zoominfo.com/pixel/KYfrEsjBKzuUx8FPC9VA loading="lazy" width="1" height="1" style="display: none;" />
</noscript>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-3790271-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-3790271-3');
</script>

<script src="https://cdn.finsweet.com/files/sweet-text/richtext-stylesystem-v1.0.min.js" data-info="code"></script>
<script>
  // On Back Button Tap
  window.onpageshow = function(event) {
    if (event.persisted) {
      window.location.reload()
    }
  };
</script>

<script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@3.6.12/dist/js/splide.min.js"></script>

<script>
  const splide = new Splide ( '#full-slider' , {
    type: 'slide',
    perPage : 1,
    arrows: true,
    
  });

	splide.mount();

 
</script>
<script>
  const halfsplide = new Splide ( '#half-slider' , {
    type: 'slide',
    perPage : 1,
    arrows: true,
    
  });

	halfsplide.mount();
  
</script>

<script>
  function validateEmail(contactemail) {
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(contactemail).toLowerCase());
  }
  $('#footer-email').keyup(function(){
    let isValid = $(this).is(':valid') && validateEmail($(this).val());
    if (isValid) {
      $('#footer-email').addClass("success");
      $('#footer-email').removeClass("error");
      $('#error-footer-email').hide();
    } else {
      $('#footer-email').removeClass("success");
      $('#footer-email').addClass("error");
      $('#error-footer-email').show();
    }
  })
  //reCAPTCHA
  $(document).ready(function() {
    function recaptchaSubmit(e) {
      e.preventDefault();
      console.log("Recaptcha submit function");
      const $this = $(this);
      grecaptcha.ready(function() {
        grecaptcha.execute('6LdtEAkeAAAAAOioARNXsjsYyY2E4hCK9B0GrUCj', {action: 'submit'}).then(function(token) {
          $this.closest('.recaptcha-check-form').submit(); 
        });
      })
    }
    $(".recaptcha-send-btn").click(recaptchaSubmit);
  });
</script>
<script>
  // removing the required attribute from checkboxes when at least one is selected
  $(function(){
    var e = $(":checkbox[required]");
    var parentID = e.parent().attr("id");
    e.change(function(){
      if(e.is(":checked")) {
        e.removeAttr("required");
        e.parent().next().hide();
      } else {
        e.attr("required","required");
        e.parent().next().show();
      }
    });
  });

  // Acoustic form validation
  $(".lp-form .AcousticForm, #preference-center, #unsubscribe").on("submit", function(event) {
    event.preventDefault();
    console.log("STARTING ACOUSTIC FORM VALIDATION");
    function validateEmail(contactemail) {
      var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      return re.test(String(contactemail).toLowerCase());
    }
    let form = $(this),
        fields = 0,
        validFields = 0;
    form.find("input:required, textarea:required, select:required").each(function() {
      var value = $(this).val(),
          id = $(this).attr("id"),
          name = $(this).attr("name"),
          type = $(this).attr("type"),
          ph = $(this).attr("placeholder"),
          isValid = value != "" && validateEmail(value),
          error = $("#error-" + id).children("div.text-small"),
          countchecked = form.find("input[name='" + name + "']:checked").length;
      fields++;
      // adding a work around for the unsubscribe form becuase it technically has two radios with different names but are supposed to act like one fieldset of radios
      if(form.attr("id") == "unsubscribe") {
        var countUnsubRadios = form.find("input[type='radio']:checked").length;
        if(countUnsubRadios > 0) {
          countchecked = 1;
        }
      }
      // validate email field is valid
      if(name == "Email" && !isValid) {
        $(this).addClass("error").removeClass("success");
        $("#error-" + id).show();
      }
      // if checkboxes and radios have a selected option
      else if((type == "checkbox" && countchecked == 0) || (type == "radio" && countchecked == 0)) {
        var parentID = form.find("input[name='" + name + "']").parent().attr("id");
        $(this).addClass("error").removeClass("success");
        $("#error-" + parentID).show();
      }
      // if drop down has changed it's value from the blank placeholder option 1
      else if($(this).is("select") && $("#" + id + " option:selected").val() == "") {
        $(this).addClass("error").removeClass("success");
        $("#error-" + id).show();
      }
      // find any blank input values
      else if(value == "") {
        $(this).addClass("error").removeClass("success");
        $("#error-" + id).show();
      }
      // if all tests pass, increase the number of valid fields, assign a success class, and hide the error message
      else {
        validFields++;
        $(this).removeClass("error").addClass("success");
        $("#error-" + id).hide();
      }
    });
    // you can only submit the form if the number of required fields is equal to the number of required valid fields
    if(fields == validFields) {
      form.find(".contact-submit-arrow-2 svg:first").hide();
      form.find(".AcousticFormLoading").css("display", "block");
      console.log("ENDING ACOUSTIC FORM VALIDATION");
      event.target.submit();
    }
  });
</script>

<!-- ACOUSTIC CAMPAIGN PREFERENCE CENTER AND OPT OUT FORM -->
<script>
  $(document).ready(function () {
    "use strict";

    // Get current date
    var d = new Date();
    var month = d.getMonth()+1;
    var day = d.getDate();
    var output = 
        (month<10 ? '0' : '') + month + '/' +
        (day<10 ? '0' : '') + day + '/' +
        d.getFullYear();
    $("input[name='Preferences Set Date'], input[name='2022 OptIn Date'], input[name='Contact Us Submission Date']").val(output);


    // EMAIL FREQUENCY - radios
    const $unsubscribe = $("#unsubscribe");
    const action = $unsubscribe.attr("action");
    const $snooze = $("#snooze");
    const $unsub = $("#unsub");

    // adding a work around for the unsubscribe form becuase it technically has two radios with different
    // names but are supposed to act like one fieldset of radios so when one is selected we don't need
    // either to be flagged as required on submit.
    function removeRequiredAttribute() {
      $unsub.removeAttr("required");
      $snooze.removeAttr("required");
    }

    $snooze.on("click", function() {
      if ($unsub.is(":checked")) {
        $unsub.prop("checked", false);
      }
      removeRequiredAttribute();
      $unsubscribe.attr("action", action + "?frequency=snoozed");
    });

    $unsub.on("click", function() {
      if ($snooze.is(":checked")) {
        $snooze.prop("checked", false);
      }
      removeRequiredAttribute();
      $unsubscribe.attr("action", action + "?frequency=unsubscribed");
    });
  });
</script>